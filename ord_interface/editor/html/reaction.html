<!doctype html>
<!--
Copyright 2020 Open Reaction Database Project Authors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css">
    <link rel="stylesheet" href="/css/reaction.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    <script src="/js/reaction.js"></script>
    <title>{{ reaction_id }}</title>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S334YDGZB8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-S334YDGZB8');
    </script>
  </head>
  <body>

    <div id="header">
      <div id="identity">
        <div style="display: flex;"><img src="{{ user_avatar }}">{{ user_name }}</div>
        {% if client_id %}
        <div style="display: flex;">
          <div style="padding: 10px; font-size: 16pt"><a href="https://docs.open-reaction-database.org/en/latest/editor.html#guest-mode" target="_blank">Guest Mode</a></div>
          <div id="login">
            <img src="https://github.githubassets.com/images/modules/logos_page/Octocat.png">
            <span>Sign in with GitHub</span>
          </div>
        </div>
        <script>
          $('#login').on('click', () => {
            location.href = "https://github.com/login/oauth/authorize?client_id={{ client_id }}";
          });
        </script>
        {% endif %}
      </div>
      <nav id="breadcrumbs" aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="/">Home</a>
          </li>
          <li class="breadcrumb-item">
            <a href="/dataset/{{ name }}">{{ name }}</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            <span id="reaction_id"></span>
          </li>
        </ol>
      </nav>
      <div id="header_buttons">
        <button type="button" id="download" onclick="ord.reaction.commit(); ord.reaction.downloadReaction();">download</button>
        <button type="button" class="add" onclick="location.href='/dataset/{{ name }}/clone/{{ index }}';">clone</button>
        <button type="button" class="remove" id="delete" style="float: none;" onclick="location.href='/dataset/{{ name }}/delete/reaction/{{ index }}';"><i class="far fa-trash-alt"></i></button>
        <button type="button" id="save" onclick="ord.reaction.commit();" style="visibility: hidden;">save</button>
        <button type="button" id="toggle_autosave" onclick="ord.utils.toggleAutosave()"></button>
        <button type="button" id="reaction_validate_button" onclick="ord.reaction.validateReaction()">validate</button>
        <div class="validate" id="reaction_validate"></div>
      </div>
    </div>

    <div id="nav">
      <div class="navSection" data-section="summary">Summary</div>
      <div class="navSection" data-section="identifiers">Identifiers</div>
      <div class="navSection" data-section="inputs">Inputs</div>
      <div id="navInputs"></div>
      <div class="navSection" data-section="setup">Setup</div>
      <div class="navSection" data-section="conditions">Conditions</div>
      <div class="navSection" data-section="notes">Notes</div>
      <div class="navSection" data-section="observations">Observations</div>
      <div class="navSection" data-section="workups">Workups</div>
      <div class="navSection" data-section="outcomes">Outcomes</div>
      <div class="navSection" data-section="provenance">Provenance</div>
    </div>

    <div id="pageLoad" class="modal show" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" style="max-width: 70px;">
        <div class="modal-content">
          <div class="modal-body">
            <div class="spinner-border" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="sections">

      <div id="section_summary" class="section" style="text-align: center">
        <div id="reaction_render" style="margin-top: 20px; margin-bottom: 20px; display: inline-block"></div>
      </div>

      <fieldset id="section_identifiers" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Identifiers</span>
          <button class="help" data-toggle="tooltip" data-placement="right" title="Reaction identifiers define descriptions of the overall reaction.">
            <span class="fa fa-question-circle" aria-hidden="true"></span>
          </button>
        </legend>
        <div id="identifiers"></div>
        <button type="button" class="add button-lg" onclick="ord.identifiers.add();"><span class="fas fa-plus" aria-hidden="true"></span> add identifier</button>
      </fieldset>

      <fieldset id="section_inputs" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Inputs</span>
          <button class="help" data-toggle="tooltip" data-placement="right" title="Reaction inputs include every chemical added to the reaction vessel.">
            <span class="fa fa-question-circle" aria-hidden="true"></span>
          </button>
        </legend>
          <div id="inputs">

            <div id="input_template" class="section input" style="display: none;">
              <fieldset class="s3">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h3">Input</span>
                  <span class="input_name edittext"></span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.input');"><i class="far fa-trash-alt"></i></button>
                  <div class="validate"></div>
               </legend>
                <div>
                  <div class="components"></div>
                  <button type="button" class="add" onclick="ord.compounds.add($(this).closest('.input'));"><span class="fas fa-plus" aria-hidden="true"></span> add component</button>
                </div>
                <div>
                  <div class="crudes"></div>
                  <button type="button" class="add" onclick="ord.crudes.add($(this).closest('.input'));"><span class="fas fa-plus" aria-hidden="true"></span> add crude component</button>
                </div>
                <fieldset class="s4">
                  <legend>
                    <span class="collapse show"></span>
                    <span class="h4">Addition information</span>
                  </legend>
                  <table class="message">
                    <tr class="input_addition_order_row"><td>addition order
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Addition order should be an integer value, starting at 1.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                    </td><td><div class="input_addition_order edittext veryshorttext integertext"></div></td></tr>
                    <tr><td>addition speed</td><td><div class="input_addition_speed_type selector" data-proto="ReactionInput_AdditionSpeed_AdditionSpeedType"></div></td><td>
                                                                details <div class="input_addition_speed_details edittext"></div></td></tr>
                    <tr><td>addition device</td><td><div class="input_addition_device_type selector" data-proto="ReactionInput_AdditionDevice_AdditionDeviceType"></div></td><td>
                                                                  details <div class="input_addition_device_details edittext"></div></td></tr>
                    <tr class="input_addition_time_row"><td>addition time
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Addition time is relative to when the first input was added.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                    </td><td>
                      <div class="input_addition_time_value edittext shorttext floattext"></div>
                      ± <div class="input_addition_time_precision edittext shorttext floattext"></div></td>
                      <td><div class="input_addition_time_units selector" data-proto="Time_TimeUnit"></div></td></tr>
                    <tr class="input_addition_duration_row"><td>addition duration
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Addition duration quantifies how long it took to add the input.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                    </td><td>
                      <div class="input_addition_duration_value edittext shorttext floattext"></div>
                      ± <div class="input_addition_duration_precision edittext shorttext floattext"></div>
                      </td><td><div class="input_addition_duration_units selector" data-proto="Time_TimeUnit"></div>
                    </td></tr>
                    <tr class="input_addition_temperature_row"><td>addition temperature
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Addition temperature specifies if the reaction input was heated or cooled prior to addition.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                    </td><td>
                      <div class="input_addition_temperature_value edittext shorttext floattext"></div>
                      ± <div class="input_addition_temperature_precision edittext shorttext floattext"></div>
                      </td><td><div class="input_addition_temperature_units selector" data-proto="Temperature_TemperatureUnit"></div>
                    </td></tr>
                  </table>
                </fieldset>
                <fieldset class="s4">
                  <legend>
                    <span class="collapse show starts_collapsed"></span>
                    <span class="h4">Flow rate</span>
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Infusion rate when running reactions in continuous flow.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                  </legend>
                  <div>
                    value <div class="input_flow_rate_value edittext shorttext floattext"></div>
                    ± <div class="input_flow_rate_precision edittext shorttext floattext"></div>
                    <div class="input_flow_rate_units selector" data-proto="FlowRate_FlowRateUnit"></div>
                  </div>
                </fieldset>
              </fieldset>
            </div>

            <div id="component_template" class="component" style="display: none;">
              <fieldset class="s4">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h4">Component</span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.component');"><i class="far fa-trash-alt"></i></button>
                  <div class="validate"></div>
                </legend>
                <table class="component_role_limiting">
                  <tr><td>reaction role</td><td><div class="component_reaction_role selector" data-proto="ReactionRole_ReactionRoleType"></div></td></tr>
                  <tr class="limiting_reactant"><td>limiting reactant</td><td><div class="component_limiting optional_bool"></div></td></tr>
                  <tr class="amount">
                    <td>amount</td>
                    <td>
                      <div class="amount_value edittext shorttext floattext"></div>
                      ± <div class="amount_precision edittext shorttext floattext"></div>
                      <select class="amount_units mass moles volume"></select>
                    </td>
                    <td class="amount_includes_solutes_label">includes solutes</td>
                    <td><div class="amount_includes_solutes optional_bool"></div></td>
                  </tr>
                </table>
                <fieldset class="s5">
                  <legend>
                    <span class="collapse show"></span>
                    <span class="h5">Identifiers</span>
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Compound identifiers should be structural (e.g., SMILES) whenever possible.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                  </legend>
                  <!-- Compound rendering -->
                  <div class="component_rendering" style="text-align: center;"></div>
                  <div class="identifiers"></div>
                  <!-- Shortcuts for name resolving & drawing -->
                  <button type="button" class="add" onclick="ord.compounds.drawIdentifier($(this).closest('.component'));"><span class="far fa-edit" aria-hidden="true"></span> draw compound</button>
                  <button type="button" class="add" onclick="ord.compounds.addNameIdentifier($(this).closest('.component'));"><span class="fa fa-search" aria-hidden="true"></span> look up name</button>
                  <!-- End shortcuts -->
                  <button type="button" class="add" onclick="ord.compounds.addIdentifier($(this).closest('.component'));"><span class="fas fa-plus" aria-hidden="true"></span> add identifier</button>
                </fieldset>
                <fieldset class="preparations_fieldset s5">
                  <legend>
                    <span class="collapse show"></span>
                    <span class="h5">Preparations</span>
                  </legend>
                  <div class="preparations"></div>
                  <button type="button" class="add" onclick="ord.compounds.addPreparation($(this).closest('.component'));"><span class="fas fa-plus" aria-hidden="true"></span> add preparation</button>
                </fieldset>
                <fieldset class="source s5">
                  <legend>
                    <span class="collapse show starts_collapsed"></span>
                    <span class="h5">Source</span>
                  </legend>
                  <table class="message">
                    <tr><td>vendor</td><td><div class="component_source_vendor edittext"></div></td></tr>
                    <tr><td>id</td><td><div class="component_source_id edittext"></div></td></tr>
                    <tr><td>lot number</td><td><div class="component_source_lot edittext"></div></td></tr>
                  </table>
                </fieldset>
                <fieldset class="s5">
                  <legend>
                    <span class="collapse show"></span>
                    <span class="h5">Features</span>
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Additional chemical features (e.g., calculated descriptors) that are important to associate with this compound.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                  </legend>
                  <div class="features"></div>
                  <button type="button" class="add" onclick="ord.compounds.addFeature($(this).closest('.component'));"><span class="fas fa-plus" aria-hidden="true"></span> add feature</button>
                </fieldset>
              </fieldset>
            </div>

            <div id="feature_template" class="feature" style="display: none;">
              <fieldset class="s5">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h5">Feature</span>
                  <span class="feature_name edittext"></span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.feature');"><i class="far fa-trash-alt"></i></button>
                </legend>
              </fieldset>
            </div>

            <div id="component_identifier_template" class="component_identifier" style="display: none; padding-bottom:10px">
              <span class="h6">Identifier</span>
              <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.component_identifier');"><i class="far fa-trash-alt"></i></button>
              <table class="message">
                <tr>
                  <td>value</td>
                  <td>
                    <div class="component_identifier_value edittext longtext"></div>
                  </td>
                  <td>
                    <button type="button" class="fa fa-upload text_upload" aria-hidden="true" style="cursor:pointer;" onclick="ord.utils.setTextFromFile($(this).closest('.component_identifier'), 'component_identifier_value');"></button>
                  </td>
                </tr>
                <tr>
                  <td>type</td>
                  <td><div class="component_identifier_type selector" data-proto="CompoundIdentifier_IdentifierType"></div></td>
                </tr>
                <tr>
                  <td>details</td>
                  <td>
                    <div class="component_identifier_details edittext longtext"></div>
                  </td>
                </tr>
              </table>
            </div>

            <div id="component_preparation_template" class="component_preparation" style="display: none;">
              type <div class="component_compound_preparation_type selector" data-proto="CompoundPreparation_PreparationType"></div>
              details <div class="component_compound_preparation_details edittext"></div>
              <span class="component_compound_preparation_reaction_id">reaction ID</span>
              <div class="component_compound_preparation_reaction component_compound_preparation_reaction_id edittext"></div>
              <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.component_preparation');"><i class="far fa-trash-alt"></i></button>
            </div>

            <div id="crude_template" class="crude" style="display: none;">
              <fieldset class="s4">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h4">Crude Component</span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.crude');"><i class="far fa-trash-alt"></i></button>
                  <button class="help" data-toggle="tooltip" data-placement="right" title="Crude components use non-isolated material from another reaction as input. The reaction ID must correspond to another reaction in this same dataset.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                </legend>
                <table class="message">
                  <tr><td>reaction ID</td><td><div class="crude_reaction edittext"></div></td></tr>
                  <tr><td>includes workup</td><td><div class="crude_includes_workup optional_bool"></div></td></tr>
                  <tr><td>has derived amount</td><td><div class="crude_has_derived optional_bool"></div></td></tr>
                  <tr class="amount">
                    <td>amount</td>
                    <td>
                      <div class="amount_value edittext shorttext floattext"></div>
                      ± <div class="amount_precision edittext shorttext floattext"></div>
                      <select class="amount_units mass volume"></select>
                    </td>
                  </tr>
                </table>
              </fieldset>
            </div>

          </div>
              <button type="button" class="add button-lg" onclick="ord.inputs.add($('#inputs'));"><span class="fas fa-plus" aria-hidden="true"></span> add input</button>
              <button type="button" class="add button-lg" onclick="ord.inputs.addInputByString($('#inputs'));"><span class="fa fa-search" aria-hidden="true"></span> resolve text</button>
      </fieldset>

      <fieldset id="section_setup" class="section s2">

        <legend>
          <span class="collapse show"></span>
          <span class="h2">Setup</span>
          <div class="validate"></div>
        </legend>
        <table class="message">
          <tr><td>vessel</td><td><div id="setup_vessel_type" class="selector" data-proto="Vessel_VesselType"></div>
                                               details <div id="setup_vessel_details" class="edittext"></td></tr>
          <tr><td>material</td><td><div id="setup_vessel_material" class="selector" data-proto="VesselMaterial_VesselMaterialType"></div>
                                                 details <div id="setup_vessel_material_details" class="edittext"></div></td></tr>
          <tr><td>volume</td><td><div id="setup_vessel_volume_value" class="edittext shorttext floattext"></div>
                                               ± <div id="setup_vessel_volume_precision" class="edittext shorttext floattext"></div>
                                               <div id="setup_vessel_volume_units" class="selector" data-proto="Volume_VolumeUnit"></div>
                                               </td></tr>
          <tr><td>automated</td><td><div id="setup_automated" class="optional_bool"></div></td></tr>
          <tr id="automation_platform"><td>platform</td><td><div id="setup_platform" class="edittext longtext"></div></td></tr>
          <tr><td>environment</td><td><div id="setup_environment_type" class="selector" data-proto="ReactionSetup_ReactionEnvironment_ReactionEnvironmentType"></div>
                                                    details <div id="setup_environment_details" class="edittext"></div></td></tr>
        </table>
        <div id="setup_codes">
          <div id="setup_code_template" class="setup_code" style="display: none;">
            <fieldset class="s4">
              <legend>
                <span class="collapse show"></span>
                <span class="h4">Automation code</span>
                <span class="setup_code_name edittext"></span>
                <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.setup_code');"><i class="far fa-trash-alt"></i></button>
                <button class="help" data-toggle="tooltip" data-placement="right" title="Details of the exact automation procedure required to perform the reaction.">
                  <span class="fa fa-question-circle" aria-hidden="true"></span>
                </button>
              </legend>
            </fieldset>
          </div>
        </div>
        <button type="button" class="add" onclick="ord.codes.addCode();"><span class="fas fa-plus" aria-hidden="true"></span> add automation code</button>
        <fieldset class="s5">
          <legend>
            <span class="collapse show"></span>
            <span class="h5">Vessel Preparations</span>
          </legend>
          <div id="setup_vessel_preparations">
            <div id="setup_vessel_preparation_template" class="setup_vessel_preparation" style="display: none;">
              preparation<div class="setup_vessel_preparation_type selector" data-proto="VesselPreparation_VesselPreparationType"></div>
              details <div class="setup_vessel_preparation_details edittext"></div>
              <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.setup_vessel_preparation');"><i class="far fa-trash-alt"></i></button>
            </div>
          </div>
          <button type="button" class="add" onclick="ord.setups.addVesselPreparation();"><span class="fas fa-plus" aria-hidden="true"></span> add preparation</button>
        </fieldset>
        <fieldset class="s5">
          <legend>
            <span class="collapse show"></span>
            <span class="h5">Vessel Attachments</span>
          </legend>
          <div id="setup_vessel_attachments">
            <div id="setup_vessel_attachment_template" class="setup_vessel_attachment" style="display: none;">
              attachment<div class="setup_vessel_attachment_type selector" data-proto="VesselAttachment_VesselAttachmentType"></div>
              details <div class="setup_vessel_attachment_details edittext"></div>
              <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.setup_vessel_attachment');"><i class="far fa-trash-alt"></i></button>
            </div>
          </div>
          <button type="button" class="add" onclick="ord.setups.addVesselAttachment();"><span class="fas fa-plus" aria-hidden="true"></span> add attachment</button>
        </fieldset>
      </fieldset>

      <fieldset id="section_conditions" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Conditions</span>
          <div class="validate"></div>
        </legend>
        <table class="message">
          <tr><td>reflux</td><td><div id="condition_reflux" class="optional_bool"></div></td></tr>
          <tr><td>pH</td><td><div id="condition_ph" class="edittext veryshorttext floattext"></div></td></tr>
          <tr><td>dynamic conditions
            <button class="help" data-toggle="tooltip" data-placement="right" title="Whether the reaction conditions cannot be fully described by the fields in this schema/form.">
              <span class="fa fa-question-circle" aria-hidden="true"></span>
            </button>
          </td><td><div id="condition_dynamic" class="optional_bool"></div></td></tr>
          <tr><td>details
            <button class="help" data-toggle="tooltip" data-placement="right" title="Elaboration on the aspects of the reaction conditions that cannot be captured by this schema in a structured format.">
              <span class="fa fa-question-circle" aria-hidden="true"></span>
            </button>
          </td><td><div id="condition_details" class="edittext paratext"></div></td></tr>
        </table>
        <fieldset id="section_conditions_temperature" class="temperature_conditions s3">
          <legend>
            <span class="collapse show"></span>
            <span class="h3">Temperature</span>
            <div class="validate"></div>
          </legend>
          <table class="message">
            <tr><td>control</td><td><div class="temperature_control selector" data-proto="TemperatureConditions_TemperatureControl_TemperatureControlType"></div>
                                                  details <div class="temperature_control_details edittext"></div></td></tr>
            <tr><td>setpoint</td><td><div class="temperature_setpoint_value edittext shorttext floattext"></div>
                                                   ± <div class="temperature_setpoint_precision edittext shorttext floattext"></div>
                                                   <div class="temperature_setpoint_units selector" data-proto="Temperature_TemperatureUnit"></div>
                                                   </td></tr>
          </table>
          <div class="temperature_measurements">
            <div id="temperature_measurement_template" class="temperature_measurement" style="display: none;">
              <fieldset class="s4">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h4">Measurement</span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.temperature_measurement');"><i class="far fa-trash-alt"></i></button>
                </legend>
                <table class="message">
                  <tr><td>type</td><td><div class="temperature_measurement_type selector" data-proto="TemperatureConditions_Measurement_MeasurementType"></div></td></tr>
                  <tr><td>temperature</td><td><div class="temperature_measurement_temperature_value edittext shorttext floattext"></div>
                    ± <div class="temperature_measurement_temperature_precision edittext shorttext floattext"></div>
                                                            <div class="temperature_measurement_temperature_units selector" data-proto="Temperature_TemperatureUnit"></div>
                                                            </td></tr>
                  <tr><td>time</td><td><div class="temperature_measurement_time_value edittext shorttext floattext"></div>
                    ± <div class="temperature_measurement_time_precision edittext shorttext floattext"></div>
                                                     <div class="temperature_measurement_time_units selector" data-proto="Time_TimeUnit"></div>
                                                     </td></tr>
                  <tr><td>details</td><td colspan="2"><div class="temperature_measurement_details edittext"></div></td></tr>
                </table>
              </fieldset>
            </div>
          </div>
          <button type="button" class="add" onclick="ord.temperature.addMeasurement($(this).closest('.temperature_conditions'));"><span class="fas fa-plus" aria-hidden="true"></span> add measurement</button>
        </fieldset>
        <fieldset id="section_conditions_stirring" class="stirring_conditions s3">
          <legend>
            <span class="collapse show"></span>
            <span class="h3">Stirring</span>
            <div class="validate"></div>
          </legend>
          <table class="message">
            <tr><td>method</td><td><div class="stirring_method_type selector" data-proto="StirringConditions_StirringMethodType"></div>
                                                 details <div class="stirring_method_details edittext"></div></td></tr>
            <tr><td>rate</td><td><div class="stirring_rate_type selector" data-proto="StirringConditions_StirringRate_StirringRateType"></div>
                                                 details <div class="stirring_rate_details edittext"></div></td></tr>
            <tr><td>rpm</td><td><div class="stirring_rpm edittext shorttext integertext"></div></td></tr>
          </table>
        </fieldset>
        <button type="button" id="show_section_conditions_pressure" class="optional" onclick="ord.utils.showOptionalSection($(this), 'section_conditions_pressure')">
          <span class="fas fa-plus" aria-hidden="true"></span> add pressure conditions
        </button>
        <fieldset id="section_conditions_pressure" class="s3" style="display: none;">
          <legend>
            <span class="collapse show"></span>
            <span class="h3">Pressure</span>
            <div class="validate"></div>
          </legend>
            <table class="message">
              <tr><td>control</td><td><div id="pressure_control_type" class="selector" data-proto="PressureConditions_PressureControl_PressureControlType"></div>
                                                    details <div id="pressure_control_details" class="edittext"></div></td></tr>
              <tr><td>setpoint</td><td><div id="pressure_setpoint_value" class="edittext shorttext floattext"></div>
                ± <div id="pressure_setpoint_precision" class="edittext shorttext floattext"></div>
                                                     <div id="pressure_setpoint_units" class="selector" data-proto="Pressure_PressureUnit"></div>
                                                     </td></tr>
              <tr><td>atmosphere</td><td><div id="pressure_atmosphere_type" class="selector" data-proto="PressureConditions_Atmosphere_AtmosphereType"></div>
                                                       details <div id="pressure_atmosphere_details" class="edittext"></div></td></tr>
            </table>
          <div id="pressure_measurements">
            <div id="pressure_measurement_template" class="pressure_measurement" style="display: none;">
              <fieldset class="s4">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h4">Measurement</span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.pressure_measurement');"><i class="far fa-trash-alt"></i></button>
                </legend>
                <table class="message">
                  <tr><td>type</td><td><div class="pressure_measurement_type selector" data-proto="PressureConditions_Measurement_MeasurementType"></div></td></tr>
                  <tr><td>pressure</td><td><div class="pressure_measurement_pressure_value edittext shorttext floattext"></div>
                    ± <div class="pressure_measurement_pressure_precision edittext shorttext floattext"></div>
                                                         <div class="pressure_measurement_pressure_units selector" data-proto="Pressure_PressureUnit"></div>
                                                         </td></tr>
                  <tr><td>time</td><td><div class="pressure_measurement_time_value edittext shorttext floattext"></div>
                    ± <div class="pressure_measurement_time_precision edittext shorttext floattext"></div>
                                                     <div class="pressure_measurement_time_units selector" data-proto="Time_TimeUnit"></div>
                                                     </td></tr>
                  <tr><td>details</td><td colspan="2"><div class="pressure_measurement_details edittext"></div></td></tr>
                </table>
              </fieldset>
            </div>
          </div>
          <button type="button" class="add" onclick="ord.pressure.addMeasurement();"><span class="fas fa-plus" aria-hidden="true"></span> add measurement</button>
        </fieldset>
        <button type="button" id="show_section_conditions_illumination" class="optional" onclick="ord.utils.showOptionalSection($(this), 'section_conditions_illumination')">
          <span class="fas fa-plus" aria-hidden="true"></span> add illumination conditions
        </button>
        <fieldset id="section_conditions_illumination" class="s3" style="display: none;">
          <legend>
            <span class="collapse show starts_collapsed"></span>
            <span class="h3">Illumination</span>
            <div class="validate"></div>
          </legend>
          <table class="message">
            <tr><td>type</td><td><div id="illumination_type" class="selector" data-proto="IlluminationConditions_IlluminationType"></div>
                                                details<div id="illumination_details" class="edittext"></div></td></tr>
            <tr><td>wavelength</td><td><div id="illumination_wavelength_value" class="edittext shorttext floattext"></div>
              ± <div id="illumination_wavelength_precision" class="edittext shorttext floattext"></div>
                                                     <div id="illumination_wavelength_units" class="selector" data-proto="Wavelength_WavelengthUnit"></div>
                                                     </td></tr>
            <tr><td>distance</td><td><div id="illumination_distance_value" class="edittext shorttext floattext"></div>
              ± <div id="illumination_distance_precision" class="edittext shorttext floattext"></div>
                                                   <div id="illumination_distance_units" class="selector" data-proto="Length_LengthUnit"></div>
                                                   </td></tr>
            <tr><td>color</td><td><div id="illumination_color" class="edittext"></div></td></tr>
          </table>
        </fieldset>
        <button type="button" id="show_section_conditions_electro" class="optional" onclick="ord.utils.showOptionalSection($(this), 'section_conditions_electro')">
          <span class="fas fa-plus" aria-hidden="true"></span> add electrochemistry conditions
        </button>
        <fieldset id="section_conditions_electro" class="s3" style="display: none;">
          <legend>
            <span class="collapse show starts_collapsed"></span>
            <span class="h3">Electrochemistry</span>
            <div class="validate"></div>
          </legend>
          <table class="message">
            <tr><td>type</td><td><div id="electro_type" class="selector" data-proto="ElectrochemistryConditions_ElectrochemistryType"></div>
                                               details <div id="electro_details" class="edittext"></div></td></tr>
            <tr><td>current</td><td><div id="electro_current_value" class="edittext shorttext floattext"></div>
              ± <div id="electro_current_precision" class="edittext shorttext floattext"></div>
                                                  <div id="electro_current_units" class="selector" data-proto="Current_CurrentUnit"></div>
                                                  </td></tr>
            <tr><td>voltage</td><td><div id="electro_voltage_value" class="edittext shorttext floattext"></div>
              ± <div id="electro_voltage_precision" class="edittext shorttext floattext"></div>
                                                  <div id="electro_voltage_units" class="selector" data-proto="Voltage_VoltageUnit"></div>
                                                  </td></tr>
            <tr><td>anode</td><td><div id="electro_anode" class="edittext"></div></td></tr>
            <tr><td>cathode</td><td><div id="electro_cathode" class="edittext"></div></td></tr>
            <tr><td>separation</td><td><div id="electro_separation_value" class="edittext shorttext floattext"></div>
              ± <div id="electro_separation_precision" class="edittext shorttext floattext"></div>
                                                     <div id="electro_separation_units" class="selector" data-proto="Length_LengthUnit"></div>
                                                     </td></tr>
            <tr><td>cell</td><td><div id="electro_cell_type" class="selector" data-proto="ElectrochemistryConditions_ElectrochemistryCell_ElectrochemistryCellType"></div>
                                               details <div id="electro_cell_details" class="edittext"></div></td></tr>
          </table>
          <div id="electro_measurements">
            <div id="electro_measurement_template" class="electro_measurement" style="display: none;">
              <fieldset class="s4">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h4">Measurement</span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.electro_measurement');"><i class="far fa-trash-alt"></i></button>
                </legend>
                <input type="radio" class="electro_measurement_current" value="current" checked> current
                <input type="radio" class="electro_measurement_voltage" value="voltage"> voltage
                <table class="message">
                  <tr><td>time</td><td><div class="electro_measurement_time_value edittext shorttext floattext"></div>
                    ± <div class="electro_measurement_time_precision edittext shorttext"></div>
                                                     <div class="electro_measurement_time_units selector" data-proto="Time_TimeUnit"></div>
                                                     </td></tr>
                  <tr class="electro_measurement_current_fields">
                    <td>current</td><td><div class="electro_measurement_current_value edittext shorttext floattext"></div>
                    ± <div class="electro_measurement_current_precision edittext shorttext floattext"></div>
                                                      <div class="electro_measurement_current_units selector" data-proto="Current_CurrentUnit"></div>
                                                      </td></tr>
                  <tr class="electro_measurement_voltage_fields" style="display: none;">
                    <td>voltage</td><td><div class="electro_measurement_voltage_value edittext shorttext floattext"></div>
                    ± <div class="electro_measurement_voltage_precision edittext shorttext floattext"></div>
                                                      <div class="electro_measurement_voltage_units selector" data-proto="Voltage_VoltageUnit"></div>
                                                      </td></tr>
                </table>
              </fieldset>
            </div>
          </div>
          <button type="button" class="add" onclick="ord.electro.addMeasurement();"><span class="fas fa-plus" aria-hidden="true"></span> add measurement</button>
        </fieldset>
        <button type="button" id="show_section_conditions_flow" class="optional" onclick="ord.utils.showOptionalSection($(this), 'section_conditions_flow')">
          <span class="fas fa-plus" aria-hidden="true"></span> add flow conditions
        </button>
        <fieldset id="section_conditions_flow" class="s3" style="display: none;">
          <legend>
            <span class="collapse show starts_collapsed"></span>
            <span class="h3">Flow</span>
            <div class="validate"></div>
          </legend>
          <table class="message">
            <tr><td>type</td><td><div id="flow_type" class="selector" data-proto="FlowConditions_FlowType"></div>
                                               details <div id="flow_details" class="edittext"></div></td></tr>
            <tr><td>pump</td><td><div id="flow_pump" class="edittext"></div></td></tr>
            <tr><td>tubing</td><td><div id="flow_tubing_type" class="selector" data-proto="FlowConditions_Tubing_TubingType"></div>
                                                 details <div id="flow_tubing_details" class="edittext"></div></td></tr>
            <tr><td>diameter</td><td><div id="flow_tubing_value" class="edittext shorttext floattext"></div>
              ± <div id="flow_tubing_precision" class="edittext shorttext floattext"></div>
                                                <div id="flow_tubing_units" class="selector" data-proto="Length_LengthUnit"></div>
                                                </td></tr>
          </table>
        </fieldset>
      </fieldset>

      <fieldset id="section_notes" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Notes</span>
          <div class="validate"></div>
        </legend>
        <table class="message">
          <tr><td>is heterogeneous</td><td><div id="notes_heterogeneous" class="optional_bool"></div></td></tr>
          <tr><td>forms precipitate</td><td><div id="notes_precipitate" class="optional_bool"></div></td></tr>
          <tr><td>is exothermic</td><td><div id="notes_exothermic" class="optional_bool"></div></td></tr>
          <tr><td>offgasses</td><td><div id="notes_offgas" class="optional_bool"></div></td></tr>
          <tr><td>moisure sensitive</td><td><div id="notes_moisture" class="optional_bool"></div></td></tr>
          <tr><td>oxygen sensitive</td><td><div id="notes_oxygen" class="optional_bool"></div></td></tr>
          <tr><td>light sensitive</td><td><div id="notes_light" class="optional_bool"></div></td></tr>
          <tr><td>safety notes</td><td><div id="notes_safety" class="edittext paratext"></div></td></tr>
          <tr><td>procedure details</td><td><div id="notes_details" class="edittext paratext"></div></td></tr>
        </table>
      </fieldset>

      <fieldset id="section_observations" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Observations</span>
          <button class="help" data-toggle="tooltip" data-placement="right" title="Observations are time-stamped comments, images, etc. that are recorded during the reaction.">
            <span class="fa fa-question-circle" aria-hidden="true"></span>
          </button>
        </legend>
        <div id="observations">
          <div id="observation_template" class="observation" style="display: none;">
            <fieldset class="s3">
              <legend>
                <span class="collapse show"></span>
                <span class="h3">Observation</span>
                <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.observation');"><i class="far fa-trash-alt"></i></button>
                <div class="validate"></div>
              </legend>
              <table class="message">
                <tr><td>time</td><td><div class="observation_time_value edittext shorttext floattext"></div>
                  ± <div class="observation_time_precision edittext shorttext floattext"></div>
                                                   <div class="observation_time_units selector" data-proto="Time_TimeUnit"></div>
                                                   </td></tr>
                <tr><td>comment</td><td><div class="observation_comment edittext"></div></td></tr>
              </table>
            </fieldset>
          </div>
        </div>
        <button type="button" class="add button-lg" onclick="ord.observations.add();"><span class="fas fa-plus" aria-hidden="true"></span> add observation</button>
      </fieldset>

      <fieldset id="section_workups" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Workups</span>
          <button class="help" data-toggle="tooltip" data-placement="right" title="Workup steps refer to any additions, purifications, or other operations after the 'reaction' stage prior to analysis.">
            <span class="fa fa-question-circle" aria-hidden="true"></span>
          </button>
        </legend>
        <div id="workups">
          <div id="workup_template" class="workup" style="display: none;">
          <fieldset class="s3">
            <legend>
              <span class="collapse show"></span>
              <span class="h3">Workup</span>
              <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.workup');"><i class="far fa-trash-alt"></i></button>
              <div class="validate"></div>
            </legend>
            <table class="message">
              <tr><td>type</td><td><div class="workup_type selector" data-proto="ReactionWorkup_WorkupType"></div></td></tr>
              <tr class="workup_keep_phase_row"><td>keep phase</td><td><div class="workup_keep_phase edittext"></div></td></tr>
              <tr class="workup_target_ph_row"><td>target ph</td><td><div class="workup_target_ph edittext veryshorttext floattext"></div></td></tr>
              <tr class="workup_duration_row"><td>duration</td><td><div class="workup_duration_value edittext shorttext floattext"></div>
                ± <div class="workup_duration_precision edittext shorttext floattext"></div>
                                                     <div class="workup_duration_units selector" data-proto="Time_TimeUnit"></div>
                                                     </td></tr>
              <tr><td>automated</td><td><div class="workup_automated optional_bool"></div></td></tr>
              <tr><td>details</td><td><div class="workup_details edittext paratext"></div></td></tr>
              <tr class="workup_amount">
                <td>aliquot amount</td>
                <td class="amount">
                  <div class="amount_value edittext shorttext floattext"></div>
                  ± <div class="amount_precision edittext shorttext floattext"></div>
                  <select class="amount_units mass volume"></select>
                </td>
              </tr>
            </table>
            <div class="workup_input">
              <!-- Shares ".input_template" with "#inputs" above. -->
            </div>
            <fieldset class="temperature_conditions s4">
              <legend>
                <span class="collapse show"></span>
                <span class="h4">Temperature</span>
                <div class="validate"></div>
              </legend>
              <table class="message">
                <tr><td>control</td><td><div class="temperature_control selector" data-proto="TemperatureConditions_TemperatureControl_TemperatureControlType"></div>
                                                      details <div class="temperature_control_details edittext"></div></td></tr>
                <tr><td>setpoint</td><td><div class="temperature_setpoint_value edittext shorttext floattext"></div>
                                                       ± <div class="temperature_setpoint_precision edittext shorttext floattext"></div>
                                                       <div class="temperature_setpoint_units selector" data-proto="Temperature_TemperatureUnit"></div>
                                                       </td></tr>
              </table>
              <div class="temperature_measurements"></div>
              <button type="button" class="add" onclick="ord.temperature.addMeasurement($(this).closest('.temperature_conditions'));"><span class="fas fa-plus" aria-hidden="true"></span> add measurement</button>
            </fieldset>
            <fieldset class="stirring_conditions s4">
              <legend>
                <span class="collapse show"></span>
                <span class="h4">Stirring</span>
                <div class="validate"></div>
              </legend>
              <table class="message">
                <tr><td>method</td><td><div class="stirring_method_type selector" data-proto="StirringConditions_StirringMethodType"></div>
                                                     details <div class="stirring_method_details edittext"></div></td></tr>
                <tr><td>rate</td><td><div class="stirring_rate_type selector" data-proto="StirringConditions_StirringRate_StirringRateType"></div>
                                                     details <div class="stirring_rate_details edittext"></div></td></tr>
                <tr><td>rpm</td><td><div class="stirring_rpm edittext shorttext integertext"></div></td></tr>
              </table>
            </fieldset>
          </fieldset>
          </div>
        </div>
        <button type="button" class="add button-lg" onclick="ord.workups.add();"><span class="fas fa-plus" aria-hidden="true"></span> add workup</button>
      </fieldset>

      <fieldset id="section_outcomes" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Outcomes</span>
          <button class="help" data-toggle="tooltip" data-placement="right" title="Outcomes record time-stamped analyses and, optionally, product characterization.">
            <span class="fa fa-question-circle" aria-hidden="true"></span>
          </button>
        </legend>

        <div id="outcomes">

          <div id="outcome_template" class="outcome" style="display: none;">
            <fieldset class="s3">
            <legend>
              <span class="collapse show"></span>
              <span class="h3">Outcome</span>
              <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.outcome');"><i class="far fa-trash-alt"></i></button>
              <div class="validate"></div>
            </legend>
            <table class="message">
              <tr><td>time
                <button class="help" data-toggle="tooltip" data-placement="right" title="The reaction time at which this analysis/characterization was performed.">
                  <span class="fa fa-question-circle" aria-hidden="true"></span>
                </button>
              </td><td><div class="outcome_time_value edittext shorttext floattext"></div>
                ± <div class="outcome_time_precision edittext shorttext floattext"></div>
                                                 <div class="outcome_time_units selector" data-proto="Time_TimeUnit"></div>
                                                 </td></tr>
              <tr><td>limiting reactant conversion
                <button class="help" data-toggle="tooltip" data-placement="right" title="Reaction conversion with respect to the limiting reactant. Yields should be associated with specific product structures, defined below.">
                  <span class="fa fa-question-circle" aria-hidden="true"></span>
                </button>
              </td><td><div class="outcome_conversion_value edittext shorttext floattext"></div>
                                                       ± <div class="outcome_conversion_precision edittext shorttext floattext"></div></td></tr>
            </table>

              <div class="outcome_analyses"></div>
              <button type="button" class="add" onclick="ord.outcomes.addAnalysis($(this).closest('.outcome'));"><span class="fas fa-plus" aria-hidden="true"></span> add analysis</button>

              <div class="outcome_products"></div>
              <button type="button" class="add" onclick="ord.products.add($(this).closest('.outcome'));"><span class="fas fa-plus" aria-hidden="true"></span> add product</button>

          </fieldset>
          </div>

          <div id="outcome_product_template" class="outcome_product" style="display: none;">
            <fieldset class="s4">
              <legend>
                <span class="collapse show"></span>
                <span class="h4">Product</span>
                <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.outcome_product');"><i class="far fa-trash-alt"></i></button>
                <div class="validate"></div>
              </legend>
              <table class="message">
              <tr><td>reaction role</td><td><div class="component_reaction_role selector" data-proto="ReactionRole_ReactionRoleType"></div></td></tr>
              <tr class="is_desired_product">
                <td>desired product
                  <button class="help" data-toggle="tooltip" data-placement="right" title="Whether this is the desired product.">
                    <span class="fa fa-question-circle" aria-hidden="true"></span>
                  </button>
                </td>
                <td><div class="outcome_product_desired optional_bool"></div></td>
              </tr>
              </table>

            <fieldset class="s5">
              <legend>
                <span class="collapse show"></span>
                <span class="h5">Identifiers</span>
                <button class="help" data-toggle="tooltip" data-placement="right" title="Compound identifiers should be structural (e.g., SMILES) whenever possible.">
                  <span class="fa fa-question-circle" aria-hidden="true"></span>
                </button>
              </legend>
              <!-- Compound rendering -->
              <div class="component_rendering" style="text-align: center;"></div>
              <div class="identifiers product_compound_identifiers"></div>
              <!-- Shortcuts for name resolving & drawing -->
              <button type="button" class="add" onclick="ord.compounds.drawIdentifier($(this).closest('.outcome_product'));"><span class="far fa-edit" aria-hidden="true"></span> draw compound</button>
              <button type="button" class="add" onclick="ord.compounds.addNameIdentifier($(this).closest('.outcome_product'));"><span class="fa fa-search" aria-hidden="true"></span> look up name</button>
              <!-- End shortcuts -->
              <button type="button" class="add" onclick="ord.compounds.addIdentifier($(this).closest('.outcome_product'));"><span class="fas fa-plus" aria-hidden="true"></span> add identifier</button>
            </fieldset>

            <div id="product_measurement_template" class="product_measurement" style="display: none;">
              <fieldset class="s6">
                <legend>
                  <span class="collapse show"></span>
                  <span class="h6">Product Measurement</span>
                  <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.product_measurement');"><i class="far fa-trash-alt"></i></button>
                  <div class="validate"></div>
                </legend>
                <table class="message product_measurement_value_type">
                  <tr>
                    <td>based on</td>
                    <td>
                      <div class="product_measurement_analysis_key selector_style">
                        <select class="analysis_key_selector">
                          <option disabled selected value="">-- select an analysis label --</option>
                        </select>
                      </div>
                    </td>
                  </tr>
                  <tr><td>type</td><td><div class="product_measurement_type selector" data-proto="ProductMeasurement_MeasurementType"></div></td></tr>
                  <tr><td>details</td><td><div class="product_measurement_details edittext"></td></tr>
                  <tbody class="product_measurement_value_group amount">
                  <tr>
                    <td class="product_measurement_section">value</td>
                    <td class="product_measurement_section">
                      <div class="product_measurement_value amount_value edittext shorttext"></div>
                      <div class="product_measurement_pm" style="display: inline-block;">±</div>
                      <div class="product_measurement_precision amount_precision edittext shorttext floattext"></div>
                      <select class="amount_units mass" style="display: none;"></select>
                    </td>
                  </tr>
                  <tr>
                    <td></td>
                    <td>
                      <input type="radio" class="product_measurement_percentage" value="percentage" checked> percentage
                      <input type="radio" class="product_measurement_float" value="float"> number
                      <input type="radio" class="product_measurement_string" value="string"> string
                      <input type="radio" class="product_measurement_mass amount_mass" value="mass"> mass
                    </td>
                  </tr>
                  </tbody>
                  <tr>
                    <td class="product_measurement_section">uses internal standard</td>
                    <td class="product_measurement_section"><div class="product_measurement_uses_internal_standard optional_bool"></div></td>
                  </tr>
                  <tr><td>is normalized
                    <button class="help" data-toggle="tooltip" data-placement="right" title="Whether the reported measurement has already been normalized to the internal standard, if an internal standard was used.">
                      <span class="fa fa-question-circle" aria-hidden="true"></span>
                    </button>
                  </td><td><div class="product_measurement_is_normalized optional_bool"></div></td></tr>
                  <tr><td>uses authentic standard</td><td><div class="product_measurement_uses_authentic_standard optional_bool"></div></td></tr>
                  <tr class="retention_time">
                    <td class="product_measurement_section">retention time</td>
                    <td class="product_measurement_section">
                      <div class="product_measurement_retention_time_value edittext shorttext floattext"></div>
                      ± <div class="product_measurement_retention_time_precision edittext shorttext floattext"></div>
                      <div class="product_measurement_retention_time_units selector" data-proto="Time_TimeUnit"></div>
                    </td>
                  </tr>
                  <tr class="wavelength">
                    <td class="product_measurement_section">wavelength</td>
                    <td class="product_measurement_section">
                      <div class="product_measurement_wavelength_value edittext shorttext floattext"></div>
                      ± <div class="product_measurement_wavelength_precision edittext shorttext floattext"></div>
                      <div class="product_measurement_wavelength_units selector" data-proto="Wavelength_WavelengthUnit"></div>
                    </td>
                  </tr>
                  <tbody class="mass_spec_details">
                  <tr>
                    <td class="product_measurement_section">mass spec type</td>
                    <td class="product_measurement_section"><div class="product_measurement_mass_spec_type selector" data-proto="ProductMeasurement_MassSpecMeasurementDetails_MassSpecMeasurementType"></div></td>
                  </tr>
                  <tr><td>mass spec details</td><td><div class="product_measurement_mass_spec_details edittext"></div></td></tr>
                  <tr><td>TIC minimum m/z</td><td><div class="product_measurement_mass_spec_tic_minimum_mz edittext shorttext floattext"></div></td></tr>
                  <tr><td>TIC maximum m/z</td><td><div class="product_measurement_mass_spec_tic_maximum_mz edittext shorttext floattext"></div></td></tr>
                  <tr>
                    <td>
                      EIC masses
                      <button class="help" data-toggle="tooltip" data-placement="right" title="Comma-separated list of m/z ratios that were used to calculate the peak area or intensity.">
                        <span class="fa fa-question-circle" aria-hidden="true"></span>
                      </button>
                    </td>
                    <td><div class="product_measurement_mass_spec_eic_masses edittext shorttext"></div></td>
                  </tr>
                  </tbody>
                  <tbody class="selectivity">
                  <tr>
                    <td class="product_measurement_section">selectivity type</td>
                    <td class="product_measurement_section"><div class="product_measurement_selectivity_type selector" data-proto="ProductMeasurement_Selectivity_SelectivityType"></div></td>
                  </tr>
                  <tr><td>selectivity details</td><td><div class="product_measurement_selectivity_details edittext"></div></td></tr>
                  </tbody>
                </table>
                <!-- Shares "#component_template" with ".components" in the input section. -->
                <div class="product_measurement_authentic_standard components"></div>

              </fieldset>
            </div>

            <fieldset class="s5">
              <legend>
                <span class="collapse show"></span>
                <span class="h5">Measurements</span>
                <button class="help" data-toggle="tooltip" data-placement="right" title="Each ProductMeasurement describes a connection between this product and an Analysis. This includes information about how the identity of the product was confirmed. It also contains quantitative standardized performance metrics like quantitative yield as well as unstandardized (and unnormalized) metrics like an integrated UV peak area.">
                  <span class="fa fa-question-circle" aria-hidden="true"></span>
                </button>
              </legend>
              <div>
                <div class="product_measurement_repeated"></div>
                <button type="button" class="add" onclick="ord.products.addMeasurement($(this).closest('.outcome_product'));"><span class="fas fa-plus" aria-hidden="true"></span> add measurement</button>
              </div>
            </fieldset>

            <fieldset class="s5">
              <legend>
                <span class="collapse show"></span>
                <span class="h5">Isolated product characteristics</span>
              </legend>
              <div class="outcome_product_isolated_characteristics">
                <table class="message">
                  <tr><td>color</td><td><div class="outcome_product_color edittext"></div></td></tr>
                  <tr><td>texture</td><td><div class="outcome_product_texture_type selector" data-proto="ProductCompound_Texture_TextureType"></div></td></tr>
                  <tr><td>texture details</td><td><div class="outcome_product_texture_details edittext"></div></td></tr>
                </table>
              </div>
            </fieldset>

            <fieldset class="s5">
              <legend>
                <span class="collapse show"></span>
                <span class="h5">Features</span>
                <button class="help" data-toggle="tooltip" data-placement="right" title="Additional chemical features (e.g., calculated descriptors) that are important to associate with this compound.">
                  <span class="fa fa-question-circle" aria-hidden="true"></span>
                </button>
              </legend>
              <div class="features"></div>
              <button type="button" class="add" onclick="ord.compounds.addFeature($(this).closest('.outcome_product'));"><span class="fas fa-plus" aria-hidden="true"></span> add feature</button>
            </fieldset>
            </fieldset>
          </div>

          <div id="outcome_analysis_template" class="outcome_analysis" style="display: none;">
            <fieldset class="s4">
              <legend>
                <span class="collapse show"></span>
                <span class="h4">Analysis</span>
                <span class="outcome_analysis_name edittext"></span>
                <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.outcome_analysis');"><i class="far fa-trash-alt"></i></button>
                <div class="validate"></div>
              </legend>
              <table class="message">
                <tr><td>type</td><td><div class="outcome_analysis_type selector" data-proto="Analysis_AnalysisType"></div></td></tr>
                <tr><td>details</td><td><div class="outcome_analysis_details edittext"></div></td></tr>
                <tr><td>chmo_id</td><td><div class="outcome_analysis_chmo_id edittext"></div></td></tr>
                <tr><td>instrument manufacturer</td><td><div class="outcome_analysis_manufacturer edittext"></div></td></tr>
                <tr><td>instrument calibration date</td><td><div class="outcome_analysis_calibrated edittext"></div></td></tr>
                <tr><td>is of isolated species
                  <button class="help" data-toggle="tooltip" data-placement="right" title="Whether this analysis is intended to be of an isolated species. If false or unspecified, the assumption is that it is of a crude product mixture (or a partially worked-up product mixture).">
                    <span class="fa fa-question-circle" aria-hidden="true"></span>
                  </button>
                </td><td><div class="outcome_analysis_is_of_isolated_species optional_bool"></div></td></tr>
              </table>

              <div>
                <div class="outcome_data_repeated">
                </div>
                <button type="button" class="add" onclick="ord.outcomes.addData($(this).closest('.outcome_analysis'));"><span class="fas fa-plus" aria-hidden="true"></span> add data</button>
              </div>

            </fieldset>

          </div>

          <div id="outcome_data_template" class="outcome_data" style="display: none;">
            <fieldset class="s5">
              <legend>
                <span class="collapse show"></span>
                <span class="h5">Analytical data</span>
                <span class="outcome_data_name edittext"></span>
                <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.outcome_data');"><i class="far fa-trash-alt"></i></button>
              </legend>
            </fieldset>
          </div>

        </div>
        <button type="button" class="add button-lg" onclick="ord.outcomes.add();"><span class="fas fa-plus" aria-hidden="true"></span> add outcome</button>
      </fieldset>

      <fieldset id="section_provenance" class="section s2">
        <legend>
          <span class="collapse show"></span>
          <span class="h2">Provenance</span>
          <button class="help" data-toggle="tooltip" data-placement="right" title="Additional metadata about how this reaction was performed and originally reported.">
            <span class="fa fa-question-circle" aria-hidden="true"></span>
          </button>
          <div class="validate"></div>
        </legend>
        <div id="provenance_experimenter">
          <table class="message">
            <tr><td>experimenter name</td><td><div class="provenance_name edittext"></div></td></tr>
            <tr><td>email</td><td><div class="provenance_email edittext"></div></td></tr>
            <tr><td>username</td><td><div class="provenance_username edittext"></div></td></tr>
            <tr><td>orcid</td><td><div class="provenance_orcid edittext"></div></td></tr>
            <tr><td>organization</td><td><div class="provenance_organization edittext"></div></td></tr>
            <tr><td>city</td><td><div id="provenance_city" class="edittext"></div></td></tr>
            <tr><td>experiment start</td><td><div id="provenance_start" class="edittext"></div></td></tr>
            <tr><td>doi</td><td><div id="provenance_doi" class="edittext"></div></td></tr>
            <tr><td>patent</td><td><div id="provenance_patent" class="edittext"></div></td></tr>
            <tr><td>publication_url</td><td><div id="provenance_url" class="edittext"></div></td></tr>
          </table>
        </div>
        <div id="provenance_created">
          <fieldset class="s4">
            <legend>
              <span class="collapse show"></span>
              <span class="h4">Record creation</span>
              <button class="help" data-toggle="tooltip" data-placement="right" title="Details about the original creation of this reaction record.">
                <span class="fa fa-question-circle" aria-hidden="true"></span>
              </button>
            </legend>
            <table class="message">
              <tr><td>time</td><td>
                <div class="provenance_time edittext"></div>
                <button type="button" onclick="$(this).prev().text(new Date().toLocaleString())">now</button>
              </td></tr>
              <tr><td>username</td><td><div class="provenance_username edittext"></div></td></tr>
              <tr><td>name</td><td><div class="provenance_name edittext"></div></td></tr>
              <tr><td>email</td><td><div class="provenance_email edittext"></div></td></tr>
              <tr><td>orcid</td><td><div class="provenance_orcid edittext"></div></td></tr>
              <tr><td>organization</td><td><div class="provenance_organization edittext"></div></td></tr>
              <tr><td>details</td><td><div class="provenance_details edittext"></div></td></tr>
            </table>
          </fieldset>
        </div>
        <div id="provenance_modifieds">
          <div id="provenance_modified_template" class="provenance_modified" style="display: none;">
            <fieldset class="s4">
              <legend>
                <span class="collapse show"></span>
                <span class="h4">Record modification</span>
                <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.provenance_modified');"><i class="far fa-trash-alt"></i></button>
                <button class="help" data-toggle="tooltip" data-placement="right" title="Details about subsequent modifications to this reaction record.">
                <span class="fa fa-question-circle" aria-hidden="true"></span>
              </button>
              </legend>
              <table class="message">
                <tr><td>time</td><td>
                  <div class="provenance_time edittext"></div>
                  <button type="button" onclick="$(this).prev().text(new Date().toLocaleString())">now</button>
                </td></tr>
                <tr><td>username</td><td><div class="provenance_username edittext"></div></td></tr>
                <tr><td>name</td><td><div class="provenance_name edittext"></div></td></tr>
                <tr><td>email</td><td><div class="provenance_email edittext"></div></td></tr>
                <tr><td>orcid</td><td><div class="provenance_orcid edittext"></div></td></tr>
                <tr><td>organization</td><td><div class="provenance_organization edittext"></div></td></tr>
                <tr><td>details</td><td><div class="provenance_details edittext"></div></td></tr>
              </table>
            </fieldset>
          </div>
        </div>
        <button type="button" class="add" onclick="ord.provenance.addModification();"><span class="fas fa-plus" aria-hidden="true"></span> add modification</button>
      </fieldset>
    </div>

    <!-- Ketcher div in a modal, js and css, and some initialization to make it work. -->
    <div class="modal fade" id="ketcher_modal" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
          <div class="modal-content" style="width: auto;">
              <div class="modal-body">
                  <iframe id="ketcher-iframe" src="/ketcher/iframe"></iframe>
                  <div id="ketcher-spinner" class="spinner-border" role="status">
                      <span class="sr-only">Loading...</span>
                  </div>
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="document.getElementById('ketcher-iframe').contentWindow.ketcher.successCallback();">Save</button>
              </div>
          </div>
      </div>
    </div>

    <div id="validate_template" class="validate_details" style="display: none;">
      <span onmouseenter="ord.utils.toggleValidateMessage($(this).siblings('.validate_message'))" onmouseleave="ord.utils.toggleValidateMessage($(this).siblings('.validate_message'))" class="validate_status fas fa-exclamation-triangle">unvalidated</span>
      <span onmouseenter="ord.utils.toggleValidateMessage($(this).siblings('.validate_warning_message'))" onmouseleave="ord.utils.toggleValidateMessage($(this).siblings('.validate_warning_message'))" class="validate_warning_status fas fa-bell"></span>
      <span class="validate_message"></span>
      <span class="validate_warning_message"></span>
    </div>

    <div id="reaction_identifier_template" class="reaction_identifier" style="display: none;">
      <span class="h6">Identifier</span>
      <button type="button" class="remove" onclick="ord.utils.removeSlowly(this, '.reaction_identifier');"><i class="far fa-trash-alt"></i></button>
      <table class="message">
        <tr>
          <td>value</td>
          <td>
            <div class="reaction_identifier_value edittext longtext"></div>
          </td>
        </tr>
        <tr>
          <td>type</td>
          <td><div class="reaction_identifier_type selector" data-proto="ReactionIdentifier_IdentifierType"></div></td>
        </tr>
        <tr>
          <td>details</td>
          <td>
            <div class="reaction_identifier_details edittext"></div>
          </td>
        </tr>
      </table>
    </div>

    <div id="data_template" class="data" style="display: none;">
      <table class="message">
      <tr>
        <td>data</td>
        <td>
          <div class="data_text edittext"></div>
          <div class="data_uploader" data-token="" style="display: none;">
            <input class="data_uploader_chooser_file data_uploader_text" type="file">
            <button type="button" class="data_uploader_chooser_button data_uploader_text">Choose...</button>
            <div class="data_uploader_file_name data_uploader_text"></div>
            <button type="button" class="data_uploader_file_retrieve data_uploader_text" onclick="ord.uploads.retrieve($(this).closest('.data_uploader'));" style="display: none;">retrieve</button>
          </div>
        </td>
      </tr>
      <tr>
        <td>type</td>
        <td>
          <input type="radio" value="text" checked> text
          <input type="radio" value="number"> number
          <input type="radio" value="url"> url
          <input type="radio" value="upload"> upload
        </td>
      </tr>
      <tr><td>description</td><td><div class="data_description edittext"></div></td></tr>
      <tr><td>file format</td><td><div class="data_format edittext"></div></td></tr>
      </table>
    </div>

    <button type="button" id="undo_template" class="undo" style="display: none;" onclick="ord.utils.undoSlowly();">undo</button>

    <script>
        document.body.onload = async function () {
          const pageLoad = $('#pageLoad');
          pageLoad.modal('show');
          {% if reaction_id %}
          await ord.reaction.initFromReactionId('{{ reaction_id }}');
          {% else %}
          await ord.reaction.initFromDataset('{{ name }}', {{ index }});
          {% endif %}
          $('.navSection').on('click', event => {
            const section = $(event.target).attr('data-section');
            $('#section_' + section)[0].scrollIntoView({behavior: 'smooth'});
          });
          ord.utils.setupObserver();
          {% if freeze %}
            ord.utils.freeze();
          {% endif %}
          pageLoad.modal('hide');
          if (location.hash) {
            const section = location.hash.replace('#', '');
            $('#section_' + section)[0].scrollIntoView({behavior: 'smooth'});
          }
        };
    </script>
  </body>
</html>
